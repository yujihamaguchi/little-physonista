jobs:
  - deployment: DeploymentJob
    variables:
      - group: Stg-Secrets
    environment: staging
    strategy:
      runOnce:
        deploy:
          steps:
            - task: UsePythonVersion@0
              inputs:
                versionSpec: '3.8'
              displayName: 'Use Python version'
            - task: AzureWebApp@1
              displayName: 'Deploy Azure Web App : egaku'
              inputs:
                azureSubscription: 'ConnectionForDeploy'
                appName: 'egaku-staging'
                package: $(Pipeline.Workspace)/drop/app.zip
                deploymentMethod: zipDeploy
                startUpCommand: 'gunicorn -b :8000 app:app'
                appSettings: |
                  -MESSAGE "$(stagingEnvMessage)"
